<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> mobile-debug · LUOYE</title><meta name="description" content="mobile-debug - Luoye"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://www.zhihu.com/people/luo-ye-42-22" target="_blank" class="nav-list-link">ZHIHU</a></li><li class="nav-list-item"><a href="https://github.com/luoye-fe" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">mobile-debug</h1><div class="post-info">2016年3月20日</div><div class="post-content"><h4 id="UC浏览器开发版（仅限安卓平台）"><a href="#UC浏览器开发版（仅限安卓平台）" class="headerlink" title="UC浏览器开发版（仅限安卓平台）"></a>UC浏览器开发版（仅限安卓平台）</h4><blockquote>
<p>超级强大，样式、脚本、资源，都可以调试，而且UC在移动端份额最大，针对性很高。</p>
</blockquote>
<p>1、 <a href="http://plus.uc.cn/document/webapp/doc5.html" target="_blank" rel="external">UC浏览器开发版</a></p>
<p>2、 官方的文档已经很详细了，包括两种调试方法，无线和有线。有线的调试很复杂，需要ADB工具，需要数据线，所以还是直接无线调试比较好。</p>
<p>3、 无线调试方法简记：</p>
<ul>
<li>安卓手机安装UC浏览器的开发版</li>
<li>保证手机和电脑在同一个局域网</li>
<li>记录下手机的ip地址，比如手机ip为 <code>10.69.5.150</code></li>
<li>在UC浏览器中打开需要调试的页面</li>
<li>电脑上打开 <code>10.69.5.150:9998</code> 即可开始开心的调试（和chrome控制台相差不大）</li>
</ul>
<h4 id="weinre本地服务器（全平台）"><a href="#weinre本地服务器（全平台）" class="headerlink" title="weinre本地服务器（全平台）"></a>weinre本地服务器（全平台）</h4><blockquote>
<p>weinre是专门的网页调试工具，它会在本地创建一个监听服务器，然后你需要在被调试页面插入一个它提供的js，然后weinre就可以监听到，然后即可开始调试。</p>
</blockquote>
<p>1、 <a href="http://people.apache.org/~pmuellr/weinre/" target="_blank" rel="external">weinre官网</a></p>
<p>2、 <a href="https://www.npmjs.com/package/weinre" target="_blank" rel="external">weinre npm</a></p>
<p>3、 调试步骤</p>
<ul>
<li>本地全局安装weinre</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> weinre -g</span><br></pre></td></tr></table></figure>
<ul>
<li>启动本地 weinre 服务</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">weinre</span> <span class="selector-tag">--boundHost</span> 10<span class="selector-class">.69</span><span class="selector-class">.5</span><span class="selector-class">.10</span> <span class="selector-tag">--httpPort</span> 9090</span><br></pre></td></tr></table></figure>
<ul>
<li>参数解释</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">--boundHost</span> 10<span class="selector-class">.69</span><span class="selector-class">.5</span><span class="selector-class">.10</span> : 在你局域网的地址开启服务</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">--httpPort</span> 9090 : 本地服务器监听端口，不设置默认为8080</span><br></pre></td></tr></table></figure>
<ul>
<li><p>访问pc调试界面<br>如果启动服务时指定了ip和端口，访问此ip的指定端口即可。<br>本例地址为： <code>http://10.69.5.10:9090/</code></p>
</li>
<li><p>在调试页面插入监听脚本<br>在调试页面中插入下图中 Target Script 中的js，本例即 <code>http://10.69.5.10:9090/target/target-script-min.js#anonymous</code>。<br><code>#anonymous</code> 这个是页面标志，不同的标志在选取目标调试页时可以起到识别作用。<br><img src="./1.png" alt=""><br>假设页面代码如下</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"format-detection"</span> <span class="attr">content</span>=<span class="string">"telephone=no"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span>我是标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://10.69.5.10:9090/target/target-script-min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在终端访问此页面（apache可以直接有个本地http服务，nodejs需要自己启一个）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在本地的2333端口开启服务，返回上面的测试页</span></span><br><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> pwd = __dirname;</span><br><span class="line"><span class="keyword">var</span> port = <span class="number">2333</span>;</span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.sendFile(pwd + <span class="string">'/test.html'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.listen(<span class="number">2333</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>此时访问 <code>10.69.5.10::2333</code> 就可以看到上面测试页的内容<br><img src="./2.png" alt=""></p>
<p>然后在局域网的其它终端访问此页面都可以看到<br><img src="./3.png" alt=""></p>
<p>此时打开 <code>http://10.69.5.10:9090/client/</code> 你会看到<br><img src="./4.png" alt=""></p>
<p>选中 Targets 里的地址即可开始调试，如下图<br><img src="./5.png" alt=""><br><img src="./6.png" alt=""></p>
<p>4、其它</p>
<p>weinre最大的缺点就是不能调试js，虽然它实现了一个简单的js解释器，能在自己的控制台操作dom，但是本身页面里的调试信息没法在这捕获，遗憾。<br>但是它支持全平台，不管是wap还是app，只要是前端的html页面，都可以调试，遇到一些奇葩的兼容性问题很好找。<br>如果真心用这个工具，我们还可以在测试服务器搭一个代理服务，任何线上页面走这个代理服务器，都会被注入那段监听的js，测试机访问代理服务器吐出的地址，pc机访问统一的控制台页面，本地什么配置都不用，就可以开始真机调试。<br>再深入的话也可以深究一下weinre的js调试问题，那就圆满了。。。脑洞ing。。。  </p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/04/12/use-webpack-in-your-node-app/" class="prev">上一篇</a></div><div data-thread-key="2016/03/20/mobile-debug/" data-title="mobile-debug" data-url="http://luoye.pw/2016/03/20/mobile-debug/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"luoye-fe"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2016 <a href="http://luoye.pw">Luoye</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-78104533-1",'auto');ga('send','pageview');</script></body></html>